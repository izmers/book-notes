<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Notes</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ingrid+Darling&display=swap" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crafty+Girls&family=Ingrid+Darling&display=swap" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

 
    <link rel="stylesheet" href="/styles/styles.css"/>
</head>
<body>
  <div class="title ingrid-darling-regular">
    <h1 class="main-title">Book Notes</h1>
  </div>

  <div class="function-bar">
    <a href="/sortby/rating" class=""><button type="button" class="btn-function btn btn-secondary ingrid-darling-regular">Sort by Rating</button></a>
    <a href="/sortby/recency" class=""><button type="button" class="btn-function btn btn-secondary ingrid-darling-regular">Sort by Recency</button></a>
    <a href="/sortby/title" class=""><button type="button" class="btn-function btn btn-secondary ingrid-darling-regular">Sort by Title</button></a>
    <a href="/add/book" class="btn-add-book"><button type="button" class="btn-function btn btn-dark ingrid-darling-regular">Add Book</button></a>
  </div>


  <div class="book-container">
    <% for (let i = 0; i < books.length; i++) { %>
        
        <div class="card" style="width: 18rem;">
            <div class="card-body">
              <h5 class="card-title crafty-girls-regular"><%= books[i].title %></h5>
              <div class="stars">
                <input class="rating-input" name="rating" hidden type="text" value="<%= books[i].rating %>"/>
                    <span id="star-1" class="fa fa-star rating-id-<%= books[i].id %>"></span>
                    <span id="star-2" class="fa fa-star rating-id-<%= books[i].id %>"></span>
                    <span id="star-3" class="fa fa-star rating-id-<%= books[i].id %>"></span>
                    <span id="star-4" class="fa fa-star rating-id-<%= books[i].id %>"></span>
                    <span id="star-5" class="fa fa-star rating-id-<%= books[i].id %>"></span>
              </div>
              <a href="/view/book/<%= books[i].id %>"><img src="<%= books[i].img %>" class="card-img-top" alt="book-image" height="250px"></a>
              <a href="/edit/book/<%= books[i].id %>" class="btn btn-primary btn-edit">Edit</a>
              <a href="/delete/book/<%= books[i].id %>">
                <button type="button" class="btn btn-danger btn-delete">Delete</button>
              </a>
            </div>
          </div>
    <% } %>
  </div>  

  <script>
        const books = <%- JSON.stringify(books) %>;
        console.log(typeof books[0].rating);
        let amountOfBooks = books.length;

        
        for (let i = 0; i < amountOfBooks; i++) {
          let rating = books[i].rating;
          const stars = document.querySelectorAll(".rating-id-" + books[i].id);
          for (let j = 0; j < rating; j++) {
            stars[j].classList.add('checked');
          }
        }

  </script>
</body>
</html>